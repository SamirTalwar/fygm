#!/usr/bin/env ruby

def run command
  unless system command
    $stderr.puts "FAIL: #{command}"
    exit 1
  end
end

puts "Symlinking configuration files"
cwd = File.expand_path File.dirname __FILE__
exclude = ["#{cwd}/init", "#{cwd}/README.md"]
home = ENV['HOME']
(Dir["#{cwd}/*"] - exclude).each do |dotfile|
  name = File.basename dotfile
  run "ln -sf '#{dotfile}' '#{home}/.#{name}'"
end

puts "Installing vim plugins"
if File.exist? "#{home}/.vim/bundle/vundle"
  run "cd ~/.vim/bundle/vundle && git pull"
else
  run "git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle"
end
run "vim +BundleInstall +BundleUpdate +qall"
